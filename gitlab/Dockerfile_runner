FROM gitlab/gitlab-runner:latest
# 13.5.0

sudo apt-get install zlib1g-dev ruby-dev gcc libffi-dev make g++


# 安装ruby
sudo apt-get install ruby ruby-dev

# 安装nodejs
sudo apt-get install nodejs

# 替换gem国内源
gem sources --add http://gems.ruby-china.com/ --remove https://rubygems.org/

sudo gem install bundler


apt-get install -y sudo vim
sudo usermod -a -G sudo gitlab-runner
sudo visudo
gitlab-runner ALL=(ALL) NOPASSWD: ALL

# 需要把sudo group的设置也改为nopasswd 否则用户的 NOPASSWD 会被覆盖不生效